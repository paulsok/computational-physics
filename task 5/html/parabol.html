
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>parabol</title><meta name="generator" content="MATLAB 7.13"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2012-05-03"><meta name="DC.source" content="parabol.m"><style type="text/css">

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">&#1055;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1099; &#1087;&#1086;&#1089;&#1090;&#1088;&#1086;&#1077;&#1085;&#1080;&#1103; &#1089;&#1093;&#1077;&#1084;&#1099;</a></li><li><a href="#3">&#1043;&#1088;&#1072;&#1085;&#1080;&#1095;&#1085;&#1099;&#1077; &#1091;&#1089;&#1083;&#1086;&#1074;&#1080;&#1103;</a></li><li><a href="#4">&#1053;&#1072;&#1095;&#1072;&#1083;&#1100;&#1085;&#1099;&#1077; &#1091;&#1089;&#1083;&#1086;&#1074;&#1080;&#1103;</a></li><li><a href="#5">&#1053;&#1077;&#1103;&#1074;&#1085;&#1072;&#1103; &#1089;&#1093;&#1077;&#1084;&#1072;</a></li><li><a href="#6">&#1040;&#1085;&#1072;&#1083;&#1080;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1086;&#1077; &#1088;&#1077;&#1096;&#1077;&#1085;&#1080;&#1077;</a></li><li><a href="#7">&#1040;&#1085;&#1080;&#1084;&#1072;&#1094;&#1080;&#1103;</a></li></ul></div><pre class="codeinput">disp(<span class="string">'"&#1056;&#1077;&#1096;&#1077;&#1085;&#1080;&#1077; &#1087;&#1077;&#1088;&#1074;&#1086;&#1081; &#1085;&#1072;&#1095;&#1072;&#1083;&#1100;&#1085;&#1086;-&#1082;&#1088;&#1072;&#1077;&#1074;&#1086;&#1081; &#1079;&#1072;&#1076;&#1072;&#1095;&#1080;'</span>)
disp(<span class="string">'&#1076;&#1083;&#1103; &#1091;&#1088;&#1072;&#1074;&#1085;&#1077;&#1085;&#1080;&#1103; &#1090;&#1077;&#1087;&#1083;&#1086;&#1087;&#1088;&#1086;&#1074;&#1086;&#1076;&#1085;&#1086;&#1089;&#1090;&#1080;'</span>)
disp(<span class="string">'&#1082;&#1086;&#1085;&#1077;&#1095;&#1085;&#1086;-&#1088;&#1072;&#1079;&#1085;&#1086;&#1089;&#1090;&#1085;&#1086;&#1081; &#1089;&#1093;&#1077;&#1084;&#1086;&#1081; (&#1085;&#1077;&#1103;&#1074;&#1085;&#1099;&#1081; &#1084;&#1077;&#1090;&#1086;&#1076;)."'</span>)
plottools;
</pre><pre class="codeoutput">"&#1056;&#1077;&#1096;&#1077;&#1085;&#1080;&#1077; &#1087;&#1077;&#1088;&#1074;&#1086;&#1081; &#1085;&#1072;&#1095;&#1072;&#1083;&#1100;&#1085;&#1086;-&#1082;&#1088;&#1072;&#1077;&#1074;&#1086;&#1081; &#1079;&#1072;&#1076;&#1072;&#1095;&#1080;
&#1076;&#1083;&#1103; &#1091;&#1088;&#1072;&#1074;&#1085;&#1077;&#1085;&#1080;&#1103; &#1090;&#1077;&#1087;&#1083;&#1086;&#1087;&#1088;&#1086;&#1074;&#1086;&#1076;&#1085;&#1086;&#1089;&#1090;&#1080;
&#1082;&#1086;&#1085;&#1077;&#1095;&#1085;&#1086;-&#1088;&#1072;&#1079;&#1085;&#1086;&#1089;&#1090;&#1085;&#1086;&#1081; &#1089;&#1093;&#1077;&#1084;&#1086;&#1081; (&#1085;&#1077;&#1103;&#1074;&#1085;&#1099;&#1081; &#1084;&#1077;&#1090;&#1086;&#1076;)."
</pre><img vspace="5" hspace="5" src="parabol_01.png" alt=""> <h2>&#1055;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1099; &#1087;&#1086;&#1089;&#1090;&#1088;&#1086;&#1077;&#1085;&#1080;&#1103; &#1089;&#1093;&#1077;&#1084;&#1099;<a name="2"></a></h2><pre class="codeinput">h=0.01;   <span class="comment">% &#1096;&#1072;&#1075; &#1087;&#1086; &#1082;&#1086;&#1086;&#1088;&#1076;&#1080;&#1085;&#1072;&#1090;&#1077;</span>
tau=0.005; <span class="comment">% &#1096;&#1072;&#1075; &#1087;&#1086; &#1074;&#1088;&#1077;&#1084;&#1077;&#1085;&#1080;</span>
d=0.1;    <span class="comment">% &#1082;&#1086;&#1101;&#1092;&#1092;&#1080;&#1094;&#1080;&#1077;&#1085;&#1090; &#1090;&#1077;&#1087;&#1083;&#1086;&#1087;&#1088;&#1086;&#1074;&#1086;&#1076;&#1085;&#1089;&#1090;&#1080;</span>
L=1;      <span class="comment">% &#1076;&#1083;&#1080;&#1085;&#1072; &#1089;&#1090;&#1088;&#1077;&#1078;&#1085;&#1103;</span>
T=10;    <span class="comment">% &#1074;&#1088;&#1077;&#1084;&#1103; &#1101;&#1074;&#1086;&#1083;&#1102;&#1094;&#1080;&#1080; &#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1099;</span>
</pre><h2>&#1043;&#1088;&#1072;&#1085;&#1080;&#1095;&#1085;&#1099;&#1077; &#1091;&#1089;&#1083;&#1086;&#1074;&#1080;&#1103;<a name="3"></a></h2><pre class="codeinput">T1=-10;         <span class="comment">% &#1090;&#1077;&#1084;&#1087;&#1077;&#1088;&#1072;&#1090;&#1091;&#1088;&#1072; U(0,t)</span>
T2=500;         <span class="comment">% &#1090;&#1077;&#1084;&#1087;&#1077;&#1088;&#1072;&#1090;&#1091;&#1088;&#1072; U(L,t)</span>
N=T/tau;
M=L/h;
temp=zeros(N,M);
temp(:,1)=T1;
temp(:,M)=T2;
</pre><h2>&#1053;&#1072;&#1095;&#1072;&#1083;&#1100;&#1085;&#1099;&#1077; &#1091;&#1089;&#1083;&#1086;&#1074;&#1080;&#1103;<a name="4"></a></h2><pre class="codeinput">temp(1,1:round(M/2))=T1;
temp(1,round(M/2)+1:M)=T2;
K=(d^2)*tau/(h^2);
k=0.8;
</pre><h2>&#1053;&#1077;&#1103;&#1074;&#1085;&#1072;&#1103; &#1089;&#1093;&#1077;&#1084;&#1072;<a name="5"></a></h2><pre>&#1052;&#1077;&#1090;&#1086;&#1076; &#1087;&#1088;&#1086;&#1075;&#1086;&#1085;&#1082;&#1080;</pre><pre class="codeinput"><span class="keyword">for</span> n=1:N-1
        a=zeros(1,M);
        b=zeros(1,M);
        a(1)=(-K)/(1+2*K);
        b(1)=(temp(n,1)+K*T1)/(1+2*K);
     <span class="keyword">for</span> i=1:M-2
            a(i+1)=(-K)./(1+2*K+K*a(i));
            b(i+1)=(temp(n,i+1)+K*b(i))./(1+2*K+K*a(i));
     <span class="keyword">end</span>;
temp(n+1,M-1)=b(M-1)-a(M-1)*T2;
     <span class="keyword">for</span> k=2:M-2
        temp(n+1,M-k)=b(M-k)-a(M-k)*temp(n+1,M-k+1);
     <span class="keyword">end</span>;
<span class="keyword">end</span>;
x=0.5*h:h:M*h-0.5*h;
y=temp(1,:);
h=plot(x,y,<span class="string">'mo'</span>);
set(h,<span class="string">'color'</span>,<span class="string">'m'</span>);
axis([0 L 0 3]);
axis <span class="string">auto</span>;
set(h,<span class="string">'EraseMode'</span>,<span class="string">'xor'</span>);
xlabel(<span class="string">'L'</span>);
ylabel(<span class="string">'T'</span>);
title(<span class="string">'Heat Transfer (partial differential equation).'</span>);
</pre><img vspace="5" hspace="5" src="parabol_02.png" alt=""> <h2>&#1040;&#1085;&#1072;&#1083;&#1080;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1086;&#1077; &#1088;&#1077;&#1096;&#1077;&#1085;&#1080;&#1077;<a name="6"></a></h2><pre class="codeinput">Y=T1+(T2-T1)*x/L;
<span class="keyword">for</span> i=1:100
 Y=Y+2*(T2-T1)*cos(i*pi/2)*sin(i*pi*x/L)/(i*pi);
<span class="keyword">end</span>;
hold <span class="string">on</span>
grid <span class="string">on</span>
hh=plot(x,Y,<span class="string">'c-.'</span>);
set(hh,<span class="string">'color'</span>,<span class="string">'g'</span>);
set(hh,<span class="string">'EraseMode'</span>,<span class="string">'xor'</span>);
pause(8);
</pre><img vspace="5" hspace="5" src="parabol_03.png" alt=""> <h2>&#1040;&#1085;&#1080;&#1084;&#1072;&#1094;&#1080;&#1103;<a name="7"></a></h2><pre class="codeinput"><span class="keyword">for</span> t=2:N
    y=temp(t,:);
    set(h,<span class="string">'XData'</span>, x,<span class="string">'YData'</span>,y);
    tt=tau*(t-1);
    Y=T1+(T2-T1)*x/L;
    <span class="keyword">for</span> i=1:100         <span class="comment">%&#1082;&#1086;&#1085;&#1077;&#1095;&#1085;&#1072;&#1103; &#1089;&#1091;&#1084;&#1084;&#1072;</span>
        Y=Y+(2*(T2-T1)*cos(i*pi/2)*sin(i*pi*x/L)<span class="keyword">...</span>
        /(i*pi))*exp(-1*(d^2)*((i*pi/L)^2)*tt);
    <span class="keyword">end</span>;
    set(hh,<span class="string">'XData'</span>,x,<span class="string">'YData'</span>,Y);
<span class="keyword">end</span>;
</pre><img vspace="5" hspace="5" src="parabol_04.png" alt=""> <p class="footer"><br>
      Published with MATLAB&reg; 7.13<br></p></div><!--
##### SOURCE BEGIN #####
disp('"Решение первой начально-краевой задачи')
disp('для уравнения теплопроводности')
disp('конечно-разностной схемой (неявный метод)."')
plottools;
%% Параметры построения схемы
h=0.01;   % шаг по координате
tau=0.005; % шаг по времени
d=0.1;    % коэффициент теплопроводнсти
L=1;      % длина стрежня
T=10;    % время эволюции системы
%% Граничные условия
T1=-10;         % температура U(0,t)
T2=500;         % температура U(L,t)
N=T/tau;
M=L/h;
temp=zeros(N,M);
temp(:,1)=T1;
temp(:,M)=T2;
%% Начальные условия
temp(1,1:round(M/2))=T1;
temp(1,round(M/2)+1:M)=T2;
K=(d^2)*tau/(h^2);
k=0.8;
%% Неявная схема 
%  Метод прогонки
for n=1:N-1
        a=zeros(1,M);
        b=zeros(1,M);
        a(1)=(-K)/(1+2*K);
        b(1)=(temp(n,1)+K*T1)/(1+2*K);
     for i=1:M-2
            a(i+1)=(-K)./(1+2*K+K*a(i));
            b(i+1)=(temp(n,i+1)+K*b(i))./(1+2*K+K*a(i)); 
     end;   
temp(n+1,M-1)=b(M-1)-a(M-1)*T2;
     for k=2:M-2
        temp(n+1,M-k)=b(M-k)-a(M-k)*temp(n+1,M-k+1);
     end;    
end; 
x=0.5*h:h:M*h-0.5*h;
y=temp(1,:);
h=plot(x,y,'mo');
set(h,'color','m');
axis([0 L 0 3]);
axis auto;
set(h,'EraseMode','xor');
xlabel('L');
ylabel('T');
title('Heat Transfer (partial differential equation).');
%% Аналитическое решение
Y=T1+(T2-T1)*x/L;
for i=1:100
 Y=Y+2*(T2-T1)*cos(i*pi/2)*sin(i*pi*x/L)/(i*pi);
end;
hold on
grid on
hh=plot(x,Y,'c-.');
set(hh,'color','g');
set(hh,'EraseMode','xor');
pause(8);
%% Анимация
for t=2:N
    y=temp(t,:);
    set(h,'XData', x,'YData',y);
    tt=tau*(t-1);
    Y=T1+(T2-T1)*x/L;
    for i=1:100         %конечная сумма
        Y=Y+(2*(T2-T1)*cos(i*pi/2)*sin(i*pi*x/L)...
        /(i*pi))*exp(-1*(d^2)*((i*pi/L)^2)*tt);
    end;
    set(hh,'XData',x,'YData',Y);
end; 

##### SOURCE END #####
--></body></html>